<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Eurostat Lakehouse — Gold Report</title>
  <style>
    :root{
      --bg:#070b14;
      --panel:#0b1224;
      --panel2:#0c1730;
      --text:#e9eefc;
      --muted:#9aa6c3;
      --line:rgba(255,255,255,.08);
      --accent:#9bd3ff;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      background: radial-gradient(1200px 600px at 35% -10%, rgba(79,140,255,.25), transparent 55%),
                  radial-gradient(900px 450px at 85% 10%, rgba(0,255,214,.14), transparent 50%),
                  var(--bg);
      color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      padding:22px;
    }
    .wrap{ max-width:1250px; margin:0 auto; }
    header{
      display:flex; justify-content:space-between; align-items:flex-start;
      gap:16px; margin-bottom:14px;
    }
    h1{ margin:0; font-size:18px; letter-spacing:.2px; }
    .sub{ color:var(--muted); font-size:12px; margin-top:6px; }
    .pill{
      display:inline-flex; gap:8px; align-items:center;
      padding:7px 10px; border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      border-radius:999px; color:var(--muted); font-size:12px;
    }
    .grid{
      display:grid;
      grid-template-columns: 360px 1fr;
      gap:14px;
      align-items:start;
    }
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.03));
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 14px;
      box-shadow: 0 8px 28px rgba(0,0,0,.35);
    }
    .card h2{
      margin:0 0 8px 0; font-size:13px; color:var(--text);
      letter-spacing:.2px;
    }
    .kpi-row{
      display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:10px;
    }
    .kpi{
      background: rgba(0,0,0,.18);
      border:1px solid var(--line);
      border-radius:12px;
      padding:10px;
    }
    .kpi .label{ color:var(--muted); font-size:11px; }
    .kpi .val{ font-size:16px; margin-top:5px; color:var(--text); font-weight:600; }
    .note{ color:var(--muted); font-size:11px; line-height:1.35; margin-top:10px; }
    .insight{
      border-left:3px solid rgba(155,211,255,.7);
      background: rgba(155,211,255,.06);
      padding:8px 10px;
      border-radius:10px;
      margin-top:10px;
    }
    .insight .t{ font-size:12px; font-weight:650; margin-bottom:3px; }
    .insight .x{ font-size:11px; color:var(--muted); line-height:1.35; }
    .right{
      display:grid;
      grid-template-columns: 1fr;
      gap:14px;
    }
    .panel-2col{
      display:grid; grid-template-columns:1fr 1fr; gap:14px;
    }
    .chart{
      background:#fff;
      border-radius: 10px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.14);
    }
    .chart img{
      display:block; width:100%; height:auto;
    }
    table{
      width:100%;
      border-collapse:collapse;
      margin-top:10px;
      font-size:11px;
      border:1px solid var(--line);
      border-radius:10px;
      overflow:hidden;
    }
    th, td{
      padding:8px 9px;
      border-bottom:1px solid var(--line);
      text-align:left;
      white-space:nowrap;
    }
    th{
      color:var(--muted);
      background: rgba(0,0,0,.22);
      font-weight:600;
      font-size:11px;
    }
    tr:last-child td{ border-bottom:none; }
    .muted{ color:var(--muted); font-size:11px; }
    .codebox{
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      background: rgba(0,0,0,.20);
      border:1px solid var(--line);
      border-radius:12px;
      padding:10px;
      font-size:10px;
      color: #cfe0ff;
      max-height: 240px;
      overflow:auto;
      line-height:1.4;
      margin-top:10px;
    }
    @media (max-width: 1040px){
      .grid{ grid-template-columns:1fr; }
      .panel-2col{ grid-template-columns:1fr; }
    }
  </style>
</head>

<body>
<div class="wrap">
  <header>
    <div>
      <h1>Eurostat Lakehouse — Gold Report</h1>
      <div class="sub">
        Generated at 2026-02-16 00:54 UTC · Indicator: <b>V11110</b> · Latest year: <b>2020</b>
         · Aggregates removed (EU/EA, *_YYYY) 
      </div>
    </div>

    <div class="pill">
      Coverage:
      <b>36</b> countries · <b>54</b> indicators · years <b>2005</b>→<b>2020</b>
    </div>
  </header>

  <div class="grid">

    <!-- LEFT COLUMN -->
    <div class="card">
      <h2>Executive snapshot</h2>
      <div class="muted">
        This report is built from the curated Gold layer. Country rankings and YoY are computed after
        aggregating to one row per (geo, indicator, year), which removes duplicated slices in the raw export.
      </div>

      <div class="kpi-row">
        <div class="kpi">
          <div class="label">Rows (aggregated)</div>
          <div class="val">23076</div>
        </div>
        <div class="kpi">
          <div class="label">Countries</div>
          <div class="val">36</div>
        </div>
        <div class="kpi">
          <div class="label">YoY rows</div>
          <div class="val">22592</div>
        </div>
        <div class="kpi">
          <div class="label">Rank delta base year</div>
          <div class="val">2015</div>
        </div>
      </div>

      <div class="note">
        <b>YoY rules:</b> prev ≥ 1.0.
        The chart is clipped at ±200.0% for readability, but the table shows real values (formatted).
      </div>

      <div class="note">
        <b>CAGR rules:</b> min years ≥ 5.
        CAGR charts are clipped at ±50.0% for readability.
      </div>

      <h2 style="margin-top:12px;">Key takeaways</h2>
      
        <div class="insight">
          <div class="t">Latest-year market leader</div>
          <div class="x">In 2020, IT leads V11110 by total country value (1.53M).</div>
        </div>
      
        <div class="insight">
          <div class="t">Fastest YoY growth (cleaned)</div>
          <div class="x">In 2020, LU grows 0.0% YoY (prev=3.78K).</div>
        </div>
      
        <div class="insight">
          <div class="t">Why YoY can look &#39;zero&#39;</div>
          <div class="x">If Value and Prev are very close, YoY becomes a small fraction and rounds to 0.0% at 1 decimal. Use Δ abs to interpret small changes.</div>
        </div>
      
        <div class="insight">
          <div class="t">Why YoY is filtered</div>
          <div class="x">YoY excludes near-zero baselines (prev &lt; 1) and the chart is clipped at ±200% for readability.</div>
        </div>
      
        <div class="insight">
          <div class="t">Biggest rank gain (value rank)</div>
          <div class="x">SK improves by +4 positions from 2015 to 2020 (Δ%=27.6%).</div>
        </div>
      
        <div class="insight">
          <div class="t">How ties are handled</div>
          <div class="x">Ranks are computed with dense ranking (ties share the same rank). Rank deltas reflect changes in the ordered position, not row index.</div>
        </div>
      
        <div class="insight">
          <div class="t">Best long-run performer (CAGR)</div>
          <div class="x">NL shows the strongest CAGR: 10.99% over 2005→2020 (min years=5).</div>
        </div>
      
        <div class="insight">
          <div class="t">Interpreting negative CAGR</div>
          <div class="x">Negative CAGR means the indicator decreases over the period. Whether that is good or bad depends on the indicator semantics.</div>
        </div>
      

      <h2 style="margin-top:12px;">Data quality signals</h2>
      
        <div class="muted">Loaded from outputs-checks/quality_report.json</div>
        <div class="codebox">{
  "checks": {
    "bronze": {
      "cols": 17,
      "has_key": true,
      "rows": 773560
    },
    "gold_country_indicator_year": {
      "cols": 4,
      "null_rate_value": 0.0,
      "rows": 6259386
    },
    "gold_yoy_growth": {
      "cols": 6,
      "rows": 5636348,
      "yoy_max": Infinity,
      "yoy_min": -100.0
    },
    "silver": {
      "cols": 7,
      "missing_expected_cols": [],
      "null_rate_value_num": 0.0,
      "null_rate_year": 0.0,
      "rows": 6259386,
      "value_num_max": 11975121582.0,
      "value_num_min": 0.0,
      "year_max": 2020,
      "year_min": 2005
    }
  },
  "errors": [],
  "files": {
    "data-bronze\\sbs_na_ind_r2_bronze.parquet": {
      "exists": true,
      "size_bytes": 23758642
    },
    "data-gold\\gold_country_indicator_year.parquet": {
      "exists": true,
      "size_bytes": 15608812
    },
    "data-gold\\gold_yoy_growth.parquet": {
      "exists": true,
      "size_bytes": 57670898
    },
    "data-silver\\sbs_na_ind_r2_silver.parquet": {
      "exists": true,
      "size_bytes": 30515298
    }
  },
  "status": "OK"
}</div>
      
    </div>

    <!-- RIGHT COLUMN -->
    <div class="right">

      <div class="card">
        <h2>Top 10 countries by value</h2>
        <div class="muted">Source: data-gold/gold_country_indicator_year.parquet · aggregated (country-year)</div>
        <div class="chart"><img src="assets/top10_value.png" alt="Top by value"/></div>

        <table>
          <thead>
            <tr>
              <th>Geo</th>
              <th>Year</th>
              <th>Value</th>
            </tr>
          </thead>
          <tbody>
          
            <tr>
              <td>IT</td>
              <td>2020</td>
              <td>1.53M</td>
            </tr>
          
            <tr>
              <td>DE</td>
              <td>2020</td>
              <td>1.18M</td>
            </tr>
          
            <tr>
              <td>FR</td>
              <td>2020</td>
              <td>1.03M</td>
            </tr>
          
            <tr>
              <td>PL</td>
              <td>2020</td>
              <td>1.01M</td>
            </tr>
          
            <tr>
              <td>ES</td>
              <td>2020</td>
              <td>766.28K</td>
            </tr>
          
            <tr>
              <td>CZ</td>
              <td>2020</td>
              <td>742.85K</td>
            </tr>
          
            <tr>
              <td>SK</td>
              <td>2020</td>
              <td>332.46K</td>
            </tr>
          
            <tr>
              <td>NL</td>
              <td>2020</td>
              <td>324.31K</td>
            </tr>
          
            <tr>
              <td>PT</td>
              <td>2020</td>
              <td>294.66K</td>
            </tr>
          
            <tr>
              <td>EL</td>
              <td>2020</td>
              <td>270.29K</td>
            </tr>
          
          </tbody>
        </table>
      </div>

      <div class="card">
        <h2>Top 10 YoY growth</h2>
        <div class="muted">Source: data-gold/gold_yoy_growth.parquet · country-only · prev ≥ 1.0</div>
        <div class="chart"><img src="assets/top10_yoy.png" alt="Top YoY"/></div>

        <table>
          <thead>
            <tr>
              <th>Geo</th>
              <th>Year</th>
              <th>Value</th>
              <th>Prev</th>
              <th>Δ abs</th>
              <th>YoY</th>
            </tr>
          </thead>
          <tbody>
          
            <tr>
              <td>LU</td>
              <td>2020</td>
              <td>3.78K</td>
              <td>3.78K</td>
              <td>1.00</td>
              <td>0.0%</td>
            </tr>
          
            <tr>
              <td>FI</td>
              <td>2020</td>
              <td>93.12K</td>
              <td>93.11K</td>
              <td>9.00</td>
              <td>0.0%</td>
            </tr>
          
            <tr>
              <td>BE</td>
              <td>2020</td>
              <td>166.12K</td>
              <td>166.11K</td>
              <td>12.00</td>
              <td>0.0%</td>
            </tr>
          
            <tr>
              <td>NO</td>
              <td>2020</td>
              <td>80.04K</td>
              <td>80.04K</td>
              <td>4.00</td>
              <td>0.0%</td>
            </tr>
          
            <tr>
              <td>DK</td>
              <td>2020</td>
              <td>78.40K</td>
              <td>78.40K</td>
              <td>3.00</td>
              <td>0.0%</td>
            </tr>
          
            <tr>
              <td>HR</td>
              <td>2020</td>
              <td>95.06K</td>
              <td>95.06K</td>
              <td>3.00</td>
              <td>0.0%</td>
            </tr>
          
            <tr>
              <td>PL</td>
              <td>2020</td>
              <td>1.01M</td>
              <td>1.01M</td>
              <td>27.00</td>
              <td>0.0%</td>
            </tr>
          
            <tr>
              <td>LV</td>
              <td>2020</td>
              <td>48.68K</td>
              <td>48.68K</td>
              <td>1.00</td>
              <td>0.0%</td>
            </tr>
          
            <tr>
              <td>SE</td>
              <td>2020</td>
              <td>204.83K</td>
              <td>204.83K</td>
              <td>2.00</td>
              <td>0.0%</td>
            </tr>
          
            <tr>
              <td>FR</td>
              <td>2020</td>
              <td>1.03M</td>
              <td>1.03M</td>
              <td>7.00</td>
              <td>0.0%</td>
            </tr>
          
          </tbody>
        </table>

        <div class="note">
          If YoY looks near zero, check <b>Δ abs</b>. When Value and Prev are very close, YoY becomes a tiny fraction and may round to 0.0% at 1 decimal.
          If this section still looks odd, raise <b>YOY_MIN_PREV_VALUE</b> (e.g., 10, 100, 1000) depending on unit scale.
        </div>
      </div>

      <div class="card">
        <h2>Trajectory: rank delta + long-run trend</h2>
        <div class="muted">
          Rank movement is computed from aggregated country-only ranking (no duplicated geo).
          Positive Δ rank means the country moved up in value rank. Dense ranking is used to handle ties (equal values share rank).
        </div>

        <div class="panel-2col" style="margin-top:10px;">
          <div>
            <div class="muted" style="margin-bottom:6px;"><b>Rank movers UP</b></div>
            <div class="chart"><img src="assets/rank_movers_up.png" alt="Rank up"/></div>
            <table>
              <thead>
                <tr><th>Geo</th><th>Rank (base→last)</th><th>Δ Rank</th><th>Δ%</th></tr>
              </thead>
              <tbody>
                
                <tr>
                  <td>SK</td>
                  <td>#11 → #7</td>
                  <td>+4</td>
                  <td>27.6%</td>
                </tr>
                
                <tr>
                  <td>HR</td>
                  <td>#20 → #17</td>
                  <td>+3</td>
                  <td>11.2%</td>
                </tr>
                
                <tr>
                  <td>NL</td>
                  <td>#10 → #8</td>
                  <td>+2</td>
                  <td>21.7%</td>
                </tr>
                
                <tr>
                  <td>HU</td>
                  <td>#14 → #12</td>
                  <td>+2</td>
                  <td>11.7%</td>
                </tr>
                
                <tr>
                  <td>RO</td>
                  <td>#13 → #11</td>
                  <td>+2</td>
                  <td>14.1%</td>
                </tr>
                
                <tr>
                  <td>DE</td>
                  <td>#3 → #2</td>
                  <td>+1</td>
                  <td>38.6%</td>
                </tr>
                
                <tr>
                  <td>BE</td>
                  <td>#15 → #14</td>
                  <td>+1</td>
                  <td>17.0%</td>
                </tr>
                
                <tr>
                  <td>AT</td>
                  <td>#17 → #16</td>
                  <td>+1</td>
                  <td>1.7%</td>
                </tr>
                
                <tr>
                  <td>NO</td>
                  <td>#22 → #21</td>
                  <td>+1</td>
                  <td>0.6%</td>
                </tr>
                
                <tr>
                  <td>SI</td>
                  <td>#21 → #20</td>
                  <td>+1</td>
                  <td>5.1%</td>
                </tr>
                
              </tbody>
            </table>
          </div>

          <div>
            <div class="muted" style="margin-bottom:6px;"><b>Rank movers DOWN</b></div>
            <div class="chart"><img src="assets/rank_movers_down.png" alt="Rank down"/></div>
            <table>
              <thead>
                <tr><th>Geo</th><th>Rank (base→last)</th><th>Δ Rank</th><th>Δ%</th></tr>
              </thead>
              <tbody>
                
                <tr>
                  <td>EL</td>
                  <td>#8 → #10</td>
                  <td>-2</td>
                  <td>-5.3%</td>
                </tr>
                
                <tr>
                  <td>IS</td>
                  <td>#31 → #33</td>
                  <td>-2</td>
                  <td>1.5%</td>
                </tr>
                
                <tr>
                  <td>SE</td>
                  <td>#12 → #13</td>
                  <td>-1</td>
                  <td>-14.8%</td>
                </tr>
                
                <tr>
                  <td>FR</td>
                  <td>#2 → #3</td>
                  <td>-1</td>
                  <td>1.8%</td>
                </tr>
                
                <tr>
                  <td>LU</td>
                  <td>#33 → #34</td>
                  <td>-1</td>
                  <td>0.6%</td>
                </tr>
                
                <tr>
                  <td>MK</td>
                  <td>#28 → #29</td>
                  <td>-1</td>
                  <td>-19.9%</td>
                </tr>
                
                <tr>
                  <td>FI</td>
                  <td>#18 → #19</td>
                  <td>-1</td>
                  <td>-3.0%</td>
                </tr>
                
                <tr>
                  <td>PL</td>
                  <td>#4 → #4</td>
                  <td>0</td>
                  <td>26.8%</td>
                </tr>
                
                <tr>
                  <td>CY</td>
                  <td>#30 → #30</td>
                  <td>0</td>
                  <td>0.4%</td>
                </tr>
                
                <tr>
                  <td>CH</td>
                  <td>#24 → #24</td>
                  <td>0</td>
                  <td>-4.6%</td>
                </tr>
                
              </tbody>
            </table>
          </div>
        </div>
      </div>

      
      <div class="card">
        <h2>Structural trend (CAGR)</h2>
        <div class="muted">
          Source: data-gold/gold_structural_metrics.parquet · country-only · min years=5 · charts clipped at ±50.0%
        </div>

        <div class="panel-2col" style="margin-top:10px;">
          <div>
            <div class="muted" style="margin-bottom:6px;"><b>Top CAGR</b></div>
            <div class="chart"><img src="assets/top10_cagr.png" alt="Top CAGR"/></div>
            <table>
              <thead><tr><th>Geo</th><th>Years</th><th>CAGR</th><th>Δ%</th></tr></thead>
              <tbody>
              
                <tr>
                  <td>NL</td>
                  <td>2005→2020</td>
                  <td>10.99%</td>
                  <td>377.61%</td>
                </tr>
              
                <tr>
                  <td>UK</td>
                  <td>2006→2018</td>
                  <td>-1.94%</td>
                  <td>-20.93%</td>
                </tr>
              
                <tr>
                  <td>CY</td>
                  <td>2005→2020</td>
                  <td>-3.11%</td>
                  <td>-37.78%</td>
                </tr>
              
                <tr>
                  <td>IE</td>
                  <td>2005→2020</td>
                  <td>-3.37%</td>
                  <td>-40.20%</td>
                </tr>
              
                <tr>
                  <td>LU</td>
                  <td>2005→2020</td>
                  <td>-3.53%</td>
                  <td>-41.67%</td>
                </tr>
              
                <tr>
                  <td>BE</td>
                  <td>2005→2020</td>
                  <td>-4.09%</td>
                  <td>-46.58%</td>
                </tr>
              
                <tr>
                  <td>SK</td>
                  <td>2005→2020</td>
                  <td>-4.11%</td>
                  <td>-46.75%</td>
                </tr>
              
                <tr>
                  <td>PL</td>
                  <td>2005→2020</td>
                  <td>-7.16%</td>
                  <td>-67.17%</td>
                </tr>
              
                <tr>
                  <td>BG</td>
                  <td>2005→2020</td>
                  <td>-7.30%</td>
                  <td>-67.90%</td>
                </tr>
              
                <tr>
                  <td>HU</td>
                  <td>2005→2020</td>
                  <td>-7.93%</td>
                  <td>-71.05%</td>
                </tr>
              
              </tbody>
            </table>
          </div>

          <div>
            <div class="muted" style="margin-bottom:6px;"><b>Bottom CAGR</b></div>
            <div class="chart"><img src="assets/bottom10_cagr.png" alt="Bottom CAGR"/></div>
            <table>
              <thead><tr><th>Geo</th><th>Years</th><th>CAGR</th><th>Δ%</th></tr></thead>
              <tbody>
              
                <tr>
                  <td>LT</td>
                  <td>2005→2020</td>
                  <td>-100.00%</td>
                  <td>-100.00%</td>
                </tr>
              
                <tr>
                  <td>IS</td>
                  <td>2015→2020</td>
                  <td>-100.00%</td>
                  <td>-100.00%</td>
                </tr>
              
                <tr>
                  <td>RS</td>
                  <td>2016→2020</td>
                  <td>-63.79%</td>
                  <td>-98.28%</td>
                </tr>
              
                <tr>
                  <td>BA</td>
                  <td>2011→2020</td>
                  <td>-29.17%</td>
                  <td>-95.52%</td>
                </tr>
              
                <tr>
                  <td>PT</td>
                  <td>2005→2020</td>
                  <td>-25.95%</td>
                  <td>-98.90%</td>
                </tr>
              
                <tr>
                  <td>NO</td>
                  <td>2007→2020</td>
                  <td>-23.40%</td>
                  <td>-96.88%</td>
                </tr>
              
                <tr>
                  <td>MK</td>
                  <td>2011→2020</td>
                  <td>-22.70%</td>
                  <td>-90.14%</td>
                </tr>
              
                <tr>
                  <td>CH</td>
                  <td>2009→2020</td>
                  <td>-20.18%</td>
                  <td>-91.63%</td>
                </tr>
              
                <tr>
                  <td>AT</td>
                  <td>2005→2020</td>
                  <td>-19.43%</td>
                  <td>-96.09%</td>
                </tr>
              
                <tr>
                  <td>RO</td>
                  <td>2005→2020</td>
                  <td>-17.17%</td>
                  <td>-94.07%</td>
                </tr>
              
              </tbody>
            </table>
          </div>
        </div>

        <div class="note">
          Tables show real values. Negative CAGR means the indicator decreases over the period; whether that is good or bad depends on the indicator semantics.
          If CAGR still looks weird, the issue is usually sparse time-series (few valid years) or a structural break in the underlying series.
        </div>
      </div>
      

      <div class="muted" style="text-align:center; padding:10px 0;">
        Eurostat Lakehouse — Gold Report (local) · generated by python + pandas + matplotlib + jinja2
      </div>

    </div>
  </div>
</div>
</body>
</html>